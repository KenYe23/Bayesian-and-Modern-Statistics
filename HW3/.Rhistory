sy_b <- sum(y_b)
smc <- 100000
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
library(latex2exp)
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
library(latex2exp)
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
library(latex2exp)
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
library(latex2exp)
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
library(latex2exp)
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
library(latex2exp)
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000000 # one billion
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
library(latex2exp)
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 1000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 10000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 10000000 # one million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 10000000 # 10 million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
library(latex2exp)
y_a <- c(12, 9, 12, 14, 13, 13, 15, 8, 15, 6)
y_b <- c(11, 11, 10, 9, 9, 8, 7, 10, 6, 8, 8, 9, 7)
a_a <- 120
b_a <- 10
a_b <- 12
b_b <- 1
n_a <- length(y_a)
sy_a <- sum(y_a)
n_b <- length(y_b)
sy_b <- sum(y_b)
smc <- 10000000 # 10 million
theta_a_mc <- rgamma(smc, a_a + sy_a, b_a + n_a)
y_a_predmc <- rpois(smc,theta_a_mc)
theta_b_mc <- rgamma(smc, a_b + sy_b, b_b + n_b)
y_b_predmc <- rpois(smc,theta_b_mc)
p1 <- mean(theta_a_mc > theta_b_mc)
p2 <- mean(y_a_predmc > y_b_predmc)
print(paste0('The Monte Carlo sample size is ', smc))
print(paste0('The probability that theta_a > theta_b given y_a and y_b is ', format(round(p1, 3))))
print(paste0('The probability that predicted Y_a > predicted Y_b given y_a and y_b is ', format(round(p2, 3))))
